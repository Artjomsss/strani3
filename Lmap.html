<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–∏–∫—Å–µ–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞ –ï–≤—Ä–æ–ø—ã</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>
    <style>
        /* ... (–≤—Å–µ —Å—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... */
    </style>
</head>
<body>
    <div class="container">
        <!-- ... (HTML —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ... -->
    </div>

    <script>
        // ... (–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase –∏ —Ü–≤–µ—Ç–∞ —Å—Ç—Ä–∞–Ω –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...

        // –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω - –§–∏–Ω–ª—è–Ω–¥–∏—è –∏ –ü—Ä–∏–±–∞–ª—Ç–∏–∫–∞ –ø–æ–¥–Ω—è—Ç—ã –Ω–∞ 5 –∫–ª–µ—Ç–æ–∫ –≤–≤–µ—Ä—Ö
        const countryPixels = {
            // –°–∫–∞–Ω–¥–∏–Ω–∞–≤–∏—è (–ø–æ–¥–Ω—è—Ç–∞ –≤–≤–µ—Ä—Ö)
            'norway': generateRectangle(20, 0, 3, 8),      // –±—ã–ª–æ (20, 5, 3, 8)
            'finland': generateRectangle(27, 0, 4, 6),     // –±—ã–ª–æ (27, 5, 4, 6)
            'denmark': generateRectangle(22, 5, 3, 2),     // –±—ã–ª–æ (22, 10, 3, 2)
            'iceland': generateRectangle(15, 0, 3, 3),     // –±—ã–ª–æ (15, 5, 3, 3)
            
            // –ë–∞–ª—Ç–∏–π—Å–∫–∏–µ —Å—Ç—Ä–∞–Ω—ã (–ø–æ–¥–Ω—è—Ç—ã –≤–≤–µ—Ä—Ö)
            'estonia': generateRectangle(28, 7, 3, 2),     // –±—ã–ª–æ (28, 12, 3, 2)
            'latvia': generateRectangle(28, 9, 3, 2),      // –±—ã–ª–æ (28, 14, 3, 2) - –ò–°–ü–†–ê–í–õ–ï–ù–û!
            'lithuania': generateRectangle(28, 11, 3, 2),  // –±—ã–ª–æ (28, 16, 3, 2)
            
            // ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å—Ç—Ä–∞–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...
        };

        // –ò–≥—Ä–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
        const gameState = {
            playerId: 'player_latvia',
            units: [],
            territories: {},
            selectedUnit: null,
            ghostUnit: null,
            radialMenu: {
                active: false,
                unit: null
            }
        };

        // –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä–º–∏–∏ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î - –ò–°–ü–†–ê–í–õ–ï–ù–ê –ü–û–ó–ò–¶–ò–Ø!
        function createArmy(size) {
            const unit = {
                id: 'unit_' + Date.now(),
                type: 'soldier',
                owner: gameState.playerId,
                position: { x: 28, y: 9 }, // –ò–°–ü–†–ê–í–õ–ï–ù–û! –ë—ã–ª–æ (28, 14) - —Ç–µ–ø–µ—Ä—å (28, 9)
                size: size,
                isMoving: false
            };

            gameState.units.push(unit);
            renderUnit(unit);
            setupUnitClick(unit);
            updateGameStats();
            
            // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –ë–î
            saveToDatabase('units/' + unit.id, unit);
            
            console.log(`‚úÖ –°–æ–∑–¥–∞–Ω–∞ –∞—Ä–º–∏—è –≤ –õ–∞—Ç–≤–∏–∏ –Ω–∞ –ø–æ–∑–∏—Ü–∏–∏ ${unit.position.x},${unit.position.y}`);
        }

        // ... (–æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...

        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è —é–Ω–∏—Ç
        function debugUnitPosition(unit) {
            const country = findCountryForPixel(unit.position.x, unit.position.y);
            console.log(`üîç –ê—Ä–º–∏—è ${unit.id} –Ω–∞ ${unit.position.x},${unit.position.y} - —Å—Ç—Ä–∞–Ω–∞: ${country || '–ú–û–†–ï/–ù–ï–¢'}`);
            
            // –ü–æ–¥—Å–≤–µ—Ç–∏–º –ø–∏–∫—Å–µ–ª—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
            const pixel = document.querySelector(`.pixel[data-x="${unit.position.x}"][data-y="${unit.position.y}"]`);
            if (pixel) {
                pixel.style.boxShadow = '0 0 10px gold';
                setTimeout(() => {
                    if (pixel.classList.contains('latvia')) {
                        pixel.style.boxShadow = '0 0 10px rgba(255,255,255,0.5)';
                    } else {
                        pixel.style.boxShadow = '';
                    }
                }, 2000);
            }
        }

        // –û–±–Ω–æ–≤–∏–º renderUnit –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
        function renderUnit(unit) {
            let unitElement = document.getElementById(unit.id);
            if (!unitElement) {
                unitElement = document.createElement('div');
                unitElement.id = unit.id;
                document.getElementById('pixel-map').appendChild(unitElement);
            }
            
            unitElement.className = `unit soldier ${unit.isMoving ? 'moving' : ''}`;
            
            // –¢–æ—á–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ü–µ–Ω—Ç—Ä–µ –ø–∏–∫—Å–µ–ª—è
            const pixelLeft = unit.position.x * 25;
            const pixelTop = unit.position.y * 25;
            const centerOffset = (25 - 20) / 2;
            
            unitElement.style.left = (pixelLeft + centerOffset) + 'px';
            unitElement.style.top = (pixelTop + centerOffset) + 'px';
            unitElement.style.background = '#3498db';
            unitElement.innerHTML = `üë•<div style="font-size:8px">${unit.size}</div>`;
            
            // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            debugUnitPosition(unit);
        }

        // ... (–æ—Å—Ç–∞–ª—å–Ω–æ–π –∫–æ–¥ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π) ...

    </script>
</body>
</html>

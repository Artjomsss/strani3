<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–°–∞–π—Ç —Å –∫–æ–¥–∞–º–∏</title>
  <link rel="stylesheet" href="style.css">
  
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"></script>
</head>
<body>
  <div class="container">
    <h1>üéÅ –°–∞–π—Ç —Å –∫–æ–¥–∞–º–∏</h1>

    <div class="stats">
      <p>üí∞ –î–µ–Ω—å–≥–∏: <span id="money">0</span></p>
      <p>‚öîÔ∏è –ê—Ä–º–∏—è: <span id="army">0</span></p>
      <p>üìà –î–æ—Ö–æ–¥: <span id="income">0</span></p>
    </div>

    <div class="input-box">
      <input type="text" id="codeInput" placeholder="–í–≤–µ–¥–∏ –∫–æ–¥">
      <button onclick="redeemCode()">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
    </div>
    <p id="message"></p>
  </div>

  <script>
    // üî• Firebase config
    const firebaseConfig = {
      apiKey: "–¢–í–û–ô_API_KEY",
      authDomain: "–¢–í–û–ô_DOMAIN.firebaseapp.com",
      databaseURL: "https://–¢–í–û–ô_DOMAIN.firebaseio.com",
      projectId: "–¢–í–û–ô_PROJECT_ID",
      storageBucket: "–¢–í–û–ô_BUCKET.appspot.com",
      messagingSenderId: "–¢–í–û–ô_SENDER_ID",
      appId: "–¢–í–û–ô_APP_ID"
    };

    const app = firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const moneyEl = document.getElementById("money");
    const armyEl = document.getElementById("army");
    const incomeEl = document.getElementById("income");
    const messageEl = document.getElementById("message");

    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–µ—Å—É—Ä—Å—ã
    db.ref("resources").on("value", snapshot => {
      const data = snapshot.val();
      moneyEl.textContent = data.money;
      armyEl.textContent = data.army;
      incomeEl.textContent = data.income;
    });

    // –ê–∫—Ç–∏–≤–∞—Ü–∏—è –∫–æ–¥–∞
    function redeemCode() {
      const code = document.getElementById("codeInput").value.trim();
      db.ref("codes/" + code).once("value").then(snapshot => {
        if (snapshot.exists()) {
          const reward = snapshot.val();
          messageEl.textContent = "‚úÖ –ö–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!";
          // –î–æ–±–∞–≤–ª—è–µ–º —Ä–µ—Å—É—Ä—Å—ã
          db.ref("resources").once("value").then(r => {
            const res = r.val();
            db.ref("resources").set({
              money: res.money + (reward.money || 0),
              army: res.army + (reward.army || 0),
              income: res.income + (reward.income || 0)
            });
          });
        } else {
          messageEl.textContent = "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥!";
        }
      });
    }
  </script>
</body>
</html>

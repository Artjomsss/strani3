<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

// Firebase config
const firebaseConfig = {
  apiKey: "AIzaSyDRUoIzXpwwAGYM0qciAYdQm-wtMKqLsVs",
  authDomain: "strani3.firebaseapp.com",
  projectId: "strani3",
  storageBucket: "strani3.firebasestorage.app",
  messagingSenderId: "225168183800",
  appId: "1:225168183800:web:825e782a35bccca89d460d",
  measurementId: "G-3NKBET5R9J"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

// Страны
const countries = [
  "Албания – не занято",
  "Андорра – не занято", 
  "Австрия – не занято",
  "Беларусь – Эля",
  "Бельгия – не занято",
  "Болгария – Костя",
  "Хорватия – Вика Дру",
  "Чехия – не занято",
  "Дания – не занято",
  "Эстония – не занято",
  "Финляндия – Лёша",
  "Франция – Полина",
  "Германия – Никита И.",
  "Греция – Милана",
  "Венгрия – не занято",
  "Исландия – не занято",
  "Ирландия – не занято",
  "Италия – Эвелина",
  "Латвия – не занято",
  "Литва – не занято",
  "Люксембург – Карпович",
  "Мальта – Арина",
  "Молдавия – не занято",
  "Монако – Катрина",
  "Черногория – Кира",
  "Нидерланды – не занято",
  "Северная Македония – не занято",
  "Норвегия – Вероника",
  "Польша – Даник",
  "Португалия – не занято"
];

const codes = {
  "ALB123": "albania.html","AND456": "andorra.html","AUT789": "austria.html",
  "BLR321": "belarus.html","BEL654": "belgium.html","BGR987": "bulgaria.html",
  "HRV147": "croatia.html","CZE258": "czechia.html","DNK369": "denmark.html",
  "EST741": "estonia.html","FIN852": "finland.html","FRA963": "france.html",
  "GER159": "germany.html","GRC357": "greece.html","HUN753": "hungary.html",
  "ISL951": "iceland.html","IRL147": "ireland.html","ITA258": "italy.html",
  "LVA369": "latvia.html","LTU741": "lithuania.html","LUX852": "luxembourg.html",
  "MLT963": "malta.html","MDA159": "moldova.html","MCO357": "monaco.html",
  "MNE753": "montenegro.html","NLD951": "netherlands.html","MKD147": "northmacedonia.html",
  "NOR258": "norway.html","POL369": "poland.html","PRT741": "portugal.html"
};

// Рендер списка стран
function renderCountries() {
  const list = document.getElementById("countryList");
  countries.forEach(c => {
    const div = document.createElement("div");
    div.className = "country-card";
    div.innerHTML = `<h2>${c}</h2>`;
    list.appendChild(div);
  });
}

// Переход по коду страны
function goToCountry() {
  const val = document.getElementById("codeInput").value.trim().toUpperCase();
  if(!val){ alert("Введите код"); return; }
  if(codes[val]){
    window.location.href = codes[val];
  } else {
    alert("Код не найден");
  }
}

// Загрузка существующих альянсов
async function loadAlliances() {
  const list = document.getElementById("alliances");
  list.innerHTML = "";
  const snapshot = await getDocs(collection(db, "alliances"));
  snapshot.forEach(doc => {
    const li = document.createElement("li");
    li.textContent = doc.data().name;
    list.appendChild(li);
  });
}

// Функция смены темы
function toggleTheme() {
  const body = document.body;
  const isDark = body.classList.contains('dark-theme');
  
  if (isDark) {
    body.classList.remove('dark-theme');
    body.classList.add('light-theme');
    localStorage.setItem('theme', 'light');
  } else {
    body.classList.remove('light-theme');
    body.classList.add('dark-theme');
    localStorage.setItem('theme', 'dark');
  }
}

// Загрузка сохраненной темы
function loadSavedTheme() {
  const savedTheme = localStorage.getItem('theme') || 'dark';
  document.body.classList.add(savedTheme + '-theme');
}

window.onload = () => {
  loadSavedTheme();
  renderCountries();
  loadAlliances();
  document.getElementById("goBtn").onclick = goToCountry;
  document.getElementById("themeToggle").onclick = toggleTheme;
};
</script>
<style>
/* Темная тема (по умолчанию) */
body.dark-theme {
  background: #111;
  color: #eee;
}

body.dark-theme .input-box input {
  background: #333;
  color: #eee;
  border: 1px solid #555;
}

body.dark-theme .country-card {
  background: #2a2a2a;
  box-shadow: 0 0 10px rgba(0,0,0,0.5);
}

body.dark-theme button {
  background: #4caf50;
  color: #fff;
}

body.dark-theme button:hover {
  background: #45a049;
}

/* Светлая тема */
body.light-theme {
  background: #f5f5f5;
  color: #333;
}

body.light-theme .input-box input {
  background: #fff;
  color: #333;
  border: 1px solid #ddd;
}

body.light-theme .country-card {
  background: #fff;
  box-shadow: 0 0 10px rgba(0,0,0,0.1);
  border: 1px solid #e0e0e0;
}

body.light-theme button {
  background: #2196F3;
  color: #fff;
}

body.light-theme button:hover {
  background: #1976D2;
}

/* Общие стили */
body {
  font-family: Arial;
  padding: 20px;
  margin: 0;
  transition: background-color 0.3s, color 0.3s;
}

h1 { 
  text-align: center;
  margin-bottom: 30px;
}

.header-controls {
  display: flex;
  justify-content: space-between;
  align-items: center;
  max-width: 900px;
  margin: 0 auto 20px;
}

.theme-toggle {
  padding: 8px 15px;
  border: none;
  border-radius: 5px;
  cursor: pointer;
  font-size: 14px;
}

.input-box { 
  text-align: center; 
  margin-bottom: 20px; 
}

input { 
  padding: 10px; 
  border-radius: 5px; 
  width: 200px; 
  transition: background-color 0.3s, color 0.3s, border 0.3s;
}

button { 
  padding: 10px 15px; 
  margin-left: 10px; 
  border: none; 
  border-radius: 5px; 
  cursor: pointer; 
  transition: background-color 0.3s;
}

.container { 
  max-width: 900px; 
  margin: auto; 
}

.country-list { 
  display: grid; 
  grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); 
  gap: 15px; 
  margin-bottom: 30px;
}

.country-card { 
  padding: 15px; 
  border-radius: 10px; 
  transition: background-color 0.3s, box-shadow 0.3s;
}

.country-card h2 { 
  margin: 0; 
  font-size: 16px;
}

.alliances-section { 
  margin-top: 40px; 
  padding-top: 20px;
  border-top: 1px solid;
}

body.dark-theme .alliances-section {
  border-color: #444;
}

body.light-theme .alliances-section {
  border-color: #ddd;
}
</style>
</head>
<body>
<div class="header-controls">
  <h1>Игра со странами и альянсами</h1>
  <button id="themeToggle" class="theme-toggle">Сменить тему</button>
</div>

<div class="input-box">
  <input type="text" id="codeInput" placeholder="Введите код страны">
  <button id="goBtn">Перейти</button>
</div>

<div class="container">
  <h2>Список стран</h2>
  <div class="country-list" id="countryList"></div>

  <div class="alliances-section">
    <h2>Существующие альянсы</h2>
    <ul id="alliances"></ul>
  </div>
</div>
</body>
</html>
